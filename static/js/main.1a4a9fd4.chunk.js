(this["webpackJsonpmeasurement-assistant-portal"]=this["webpackJsonpmeasurement-assistant-portal"]||[]).push([[0],{1035:function(e,t,a){},1045:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(23),c=a.n(r),o=(a(277),a(2)),i=a(34),u=a.n(i),l=a(70),d=a(14),j=a(253),b=a(1054),p=a(1052),m=a(1051),h=a(1053),g=a(171),O=a(169),x=a(64),f=a(65),v=a(170),y=a.n(v),k=function(){function e(){Object(x.a)(this,e)}return Object(f.a)(e,[{key:"createUser",value:function(){var e=Object(l.a)(u.a.mark((function e(t){var a,n,s,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),a=t.googleId,n=t.profileObj.email,s=t.tokenId,e.prev=4,e.next=7,y()({url:"https://measurment-assistant.herokuapp.com/api/user",method:"POST",headers:{Authorization:s},data:{googleId:a,email:n}});case 7:return r=e.sent,e.abrupt("return",r.data.userData);case 11:return e.prev=11,e.t0=e.catch(4),e.abrupt("return",e.t0);case 14:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"updateAccessKey",value:function(){var e=Object(l.a)(u.a.mark((function e(t,a,n){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y()({url:"https://measurment-assistant.herokuapp.com/api/user/accesskey",method:"PUT",headers:{Authorization:a},data:{googleId:n,email:t}});case 3:return s=e.sent,e.abrupt("return",s.data.userData);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,a,n){return e.apply(this,arguments)}}()}]),e}(),K=(a(1035),a(1036),a(1));var I=function(){var e,t,a=Object(b.a)(["UserData"]),s=Object(d.a)(a,3),r=s[0],c=s[1],i=s[2],x=Object(n.useState)({username:null===(e=r.UserData)||void 0===e?void 0:e.username,accessKey:null===(t=r.UserData)||void 0===t?void 0:t.accessKey}),f=Object(d.a)(x,2),v=f[0],y=f[1],I=Object(n.useState)(!1),w=Object(d.a)(I,2),D=w[0],U=w[1];Object(n.useEffect)((function(){v.accessKey&&v.username&&c("UserData",{username:v.username,accessKey:v.accessKey},{maxAge:1800})}),[v]);var S=new k,N=function(){var e=Object(l.a)(u.a.mark((function e(t){var a,n,s,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.createUser(t);case 2:a=e.sent,n=a.accessKey,s=a.username,r=t.tokenId,c=t.googleId,y({accessKey:n,username:s,tokenId:r,googleId:c});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(l.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.updateAccessKey(v.username,v.tokenId,v.googleId);case 2:"Error"==(t=e.sent).name?U(!0):(a=t.accessKey,y(Object(o.a)(Object(o.a)({},v),{},{accessKey:a})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(K.jsxs)("div",{className:"App",children:[Object(K.jsx)(p.a,{bg:"light",expand:"lg",children:Object(K.jsxs)(m.a,{children:[Object(K.jsx)(p.a.Brand,{href:"#home",children:"Measurement Assistant"}),Object(K.jsx)(p.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(K.jsxs)(p.a.Collapse,{id:"basic-navbar-nav",children:[Object(K.jsx)(h.a,{className:"me-auto",children:Object(K.jsx)(h.a.Link,{href:"#home",children:"Documents"})}),Object(K.jsx)(h.a,{className:"justify-content-end",children:r.UserData?Object(K.jsxs)(K.Fragment,{children:[Object(K.jsxs)("small",{className:"userName",children:["Signed in as ",v.username]}),Object(K.jsx)(O.GoogleLogout,{clientId:"759950908416-hdi0alconb3krbcblsmidir074uvafoj.apps.googleusercontent.com",buttonText:"Sign out",onLogoutSuccess:function(){i("UserData"),y({})}})]}):Object(K.jsx)(K.Fragment,{})})]})]})}),Object(K.jsx)("div",{className:"accessKeyContainer",children:Object(K.jsxs)("div",{className:"accessKeyInput",children:[Object(K.jsx)("input",{type:"text",value:r.UserData?v.accessKey:"Log in with google to get access key"}),r.UserData?Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)("button",{className:"btnToClipboard",onClick:function(){navigator.clipboard.writeText(v.accessKey)},children:"\u274f"}),Object(K.jsx)("button",{className:"btnToClipboard",onClick:T,children:"\u21bb"})]}):Object(K.jsx)(O.GoogleLogin,{clientId:"759950908416-hdi0alconb3krbcblsmidir074uvafoj.apps.googleusercontent.com",buttonText:"Sign in",onSuccess:N,onFailure:N,cookiePolicy:"single_host_origin"})]})}),1==D?Object(K.jsxs)(g.a,{variant:"danger",onClose:function(){return U(!1)},dismissible:!0,children:[Object(K.jsx)(g.a.Heading,{children:"Oops!"}),Object(K.jsx)("p",{children:"You should sign in again"})]}):Object(K.jsx)(K.Fragment,{}),Object(K.jsx)(j.a,{supportedSubmitMethods:[],url:"https://measurment-assistant.herokuapp.com/documentation/json"})]})};a(1040);c.a.render(Object(K.jsx)(s.a.StrictMode,{children:Object(K.jsx)(I,{})}),document.getElementById("root"))},277:function(e,t,a){},997:function(e,t){},999:function(e,t){}},[[1045,1,2]]]);
//# sourceMappingURL=main.1a4a9fd4.chunk.js.map